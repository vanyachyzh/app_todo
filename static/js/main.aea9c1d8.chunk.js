(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],[,,,,,,function(e,t,n){"use strict";var r=n(16);n.o(r,"ErrorType")&&n.d(t,"ErrorType",(function(){return r.ErrorType})),n.o(r,"Filter")&&n.d(t,"Filter",(function(){return r.Filter})),n.o(r,"KeyType")&&n.d(t,"KeyType",(function(){return r.KeyType}));var c=n(17);n.d(t,"ErrorType",(function(){return c.a}));var o=n(9);n.d(t,"Filter",(function(){return o.a}));var a=n(18);n.o(a,"KeyType")&&n.d(t,"KeyType",(function(){return a.KeyType}));var s=n(19);n.o(s,"KeyType")&&n.d(t,"KeyType",(function(){return s.KeyType}));var i=n(20);n.o(i,"KeyType")&&n.d(t,"KeyType",(function(){return i.KeyType}));var u=n(21);n.d(t,"KeyType",(function(){return u.a}));n(22)},,,function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.All="All",e.Completed="Completed",e.Active="Active"}(r||(r={}))},,,,,,,function(e,t){},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.EmptyTitle="Title can't be empty",e.Delete="Unable to delete a todo",e.Add="Unable to add a todo",e.Update="Unable to update a todo",e.None="None"}(r||(r={}))},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Enter="Enter",e.Escape="Escape"}(r||(r={}))},function(e,t){},,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),o=n(23),a=n.n(o),s=n(14),i=n(3),u=n(2),l=n.n(u),d=n(4),p=n(7),f=n.n(p),j="https://mate.academy/students-api";function b(e){return new Promise((function(t){setTimeout(t,e)}))}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r={method:t};return n&&(r.body=JSON.stringify(n),r.headers={"Content-Type":"application/json; charset=UTF-8"}),b(300).then((function(){return fetch(j+e,r)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var O=function(e){return m(e)},h=function(e,t){return m(e,"POST",t)},v=function(e,t){return m(e,"PATCH",t)},y=function(e){return m(e,"DELETE")},x=function(){var e=Object(d.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/users?email=".concat(t));case 2:return n=e.sent,e.abrupt("return",n[0]||null);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.name,e.abrupt("return",h("/users",{email:n,name:r}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=n(1),N=function(e){var t=e.onLogin,n=Object(r.useState)(""),c=Object(i.a)(n,2),o=c[0],a=c[1],s=Object(r.useState)(""),u=Object(i.a)(s,2),p=u[0],j=u[1],b=Object(r.useState)(!1),m=Object(i.a)(b,2),O=m[0],h=m[1],v=Object(r.useState)(!1),y=Object(i.a)(v,2),N=y[0],_=y[1],E=Object(r.useState)(""),k=Object(i.a)(E,2),S=k[0],C=k[1],w=function(e){t(e)};Object(r.useEffect)((function(){var e=localStorage.getItem("user");if(e)try{var n=JSON.parse(e);t(n)}catch(r){}}),[]);var K=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(o);case 2:(t=e.sent)?w(t):h(!0);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),C(""),_(!0),e.prev=3,!O){e.next=9;break}return e.next=7,T({name:p,email:o}).then(w);case 7:e.next=11;break;case 9:return e.next=11,K();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),C("Something went wrtong");case 16:return e.prev=16,_(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})));return function(t){return e.apply(this,arguments)}}();return Object(g.jsxs)("form",{onSubmit:A,className:"box mt-5",children:[Object(g.jsx)("h1",{className:"title is-3",children:O?"You need to register":"Log in to open todos"}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",htmlFor:"user-email",children:"Email"}),Object(g.jsxs)("div",{className:f()("control has-icons-left",{"is-loading":N}),children:[Object(g.jsx)("input",{type:"email",id:"user-email",className:f()("input",{"is-danger":!O&&S}),placeholder:"Enter your email",disabled:N||O,value:o,required:!0,onChange:function(e){return a(e.target.value)}}),Object(g.jsx)("span",{className:"icon is-small is-left",children:Object(g.jsx)("i",{className:"fas fa-envelope"})})]}),!O&&S&&Object(g.jsx)("p",{className:"help is-danger",children:S})]}),O&&Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"label",htmlFor:"user-name",children:"Your Name"}),Object(g.jsxs)("div",{className:f()("control has-icons-left",{"is-loading":N}),children:[Object(g.jsx)("input",{type:"text",id:"user-name",className:f()("input",{"is-danger":O&&S}),placeholder:"Enter your name",required:!0,minLength:4,disabled:N,value:p,onChange:function(e){return j(e.target.value)}}),Object(g.jsx)("span",{className:"icon is-small is-left",children:Object(g.jsx)("i",{className:"fas fa-user"})})]}),O&&S&&Object(g.jsx)("p",{className:"help is-danger",children:S})]}),Object(g.jsx)("div",{className:"field",children:Object(g.jsx)("button",{type:"submit",className:f()("button is-primary",{"is-loading":N}),children:O?"Register":"Login"})})]})},_=c.a.createContext(null),E=function(e){var t=e.children,n=Object(r.useState)(null),c=Object(i.a)(n,2),o=c[0],a=c[1];return o?Object(g.jsx)(_.Provider,{value:o,children:t}):Object(g.jsx)(N,{onLogin:a})},k=(n(30),n(31),n(32),n(33),n(5)),S=n(9),C=function(e){return e.filter((function(e){return!e.completed})).length},w=function(e){return e.some((function(e){return e.completed}))},K=function(e){var t=e.addTodo,n=e.tempTodo,c=e.toggleCompletedStatus,o=e.todos,a=Object(r.useState)(""),s=Object(i.a)(a,2),u=s[0],l=s[1];return Object(g.jsxs)("header",{className:"todoapp__header",children:[Object(g.jsx)("button",{type:"button",className:f()("todoapp__toggle-all",{active:!C(o)}),onClick:c}),Object(g.jsx)("form",{onSubmit:function(e){e.preventDefault(),t(u),l("")},children:Object(g.jsx)("input",{disabled:!!n,name:"title",value:u,onChange:function(e){l(e.target.value)},type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?"})})]})},A=n(6),F=function(e){var t=e.todo,n=e.removeTodo,c=e.removedTodoId,o=e.updateTodo,a=e.isLoadingAll,s=t.id,u=t.title,l=t.completed,d=Object(r.useState)(u),p=Object(i.a)(d,2),j=p[0],b=p[1],m=Object(r.useState)(""),O=Object(i.a)(m,2),h=O[0],v=O[1],y=Object(r.useState)(!0),x=Object(i.a)(y,2),T=x[0],N=x[1],_=!1,E=j!==h,k=function(e){N(!0),v(""),e.currentTarget.blur()},S=function(e){o(s,{title:e.currentTarget.value}),b(e.currentTarget.value),k(e)};return Object(g.jsxs)("li",{className:f()("todo",{completed:l}),children:[Object(g.jsx)("label",{className:"todo__status-label",children:Object(g.jsx)("input",{type:"checkbox",className:"todo__status",checked:l,onChange:function(){o(s,{completed:!l})}})}),Object(g.jsx)("input",{type:"text",placeholder:j,value:h,onChange:function(e){v(e.target.value)},onDoubleClick:function(e){!function(e){N(!1),v(j),e.currentTarget.focus()}(e)},className:f()("todo__title",{"todo__title-transparent":!T}),readOnly:T,onKeyDown:function(e){e.key!==A.KeyType.Enter||h||n(s),e.key===A.KeyType.Enter&&!E&&h&&k(e),e.key===A.KeyType.Enter&&E&&h&&S(e),e.key===A.KeyType.Escape&&(_=!0,e.currentTarget.blur(),_=!1)},onBlur:function(e){_?k(e):h?E?E&&S(e):k(e):n(s)}}),Object(g.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){return n(s)},hidden:!T,children:"\xd7"}),(c===s||a)&&Object(g.jsxs)("div",{className:"overlay",children:[Object(g.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(g.jsx)("div",{className:"loader"})]})]})},I=function(e){var t=e.todos,n=e.tempTodo,r=e.removeTodo,c=e.removedTodoId,o=e.updateTodo,a=e.isLoadingAll;return Object(g.jsxs)("ul",{className:"todoapp__main",children:[t.map((function(e){return Object(g.jsx)(F,{todo:e,removeTodo:r,removedTodoId:c,updateTodo:o,isLoadingAll:a},e.id)})),n&&Object(g.jsxs)("div",{className:"todo",children:[Object(g.jsx)("label",{className:"todo__status-label",children:Object(g.jsx)("input",{type:"checkbox",className:"todo__status"})}),Object(g.jsx)("input",{defaultValue:n.title,className:"todo__title",disabled:!0}),Object(g.jsx)("button",{type:"button",className:"todo__remove",children:"\xd7"}),Object(g.jsxs)("div",{className:"overlay",children:[Object(g.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(g.jsx)("div",{className:"loader"})]})]})]})},L=["All","Active","Completed"],D=function(e){return y("/todos/".concat(e))},P=function(e,t){return v("/todos/".concat(e),t)},U=function(e){var t=e.todos,n=e.setFilter,r=e.filter,c=e.removeCompletedTodos,o=function(e){var t=e.currentTarget.textContent;t&&n(A.Filter[t])};return Object(g.jsxs)("footer",{className:"todoapp__footer",children:[Object(g.jsx)("span",{className:"todo-count",children:"".concat(C(t)," items left")}),Object(g.jsx)("nav",{className:"filter",children:L.map((function(e){return Object(g.jsx)(s.b,{to:"All"===e?"../":"../".concat(e.toLowerCase()),className:f()("filter__link",{selected:e===r}),onClick:o,children:e},e)}))}),Object(g.jsx)("button",{type:"button",className:f()("todoapp__clear-completed",{"todoapp__clear-completed-disabled":!w(t)}),onClick:c,children:"Clear completed"})]})},J=function(e){var t=e.setError,n=e.errorText,c=Object(r.useState)(!0),o=Object(i.a)(c,2),a=o[0],s=o[1],u=function(){s(!1),setTimeout((function(){t({state:!1,type:A.ErrorType.None})}),1e3)};return Object(r.useEffect)((function(){setTimeout((function(){u()}),3e3)}),[]),Object(g.jsxs)("div",{className:f()("notification","is-danger","is-light","has-text-weight-normal",{hidden:!a}),children:[Object(g.jsx)("button",{type:"button",className:"delete",onClick:u}),n]})},q={state:!1,type:A.ErrorType.None},B=function(){var e=Object(r.useContext)(_),t=(null===e||void 0===e?void 0:e.id)||0,n=Object(r.useState)([]),c=Object(i.a)(n,2),o=c[0],a=c[1],s=Object(r.useState)(null),u=Object(i.a)(s,2),p=u[0],f=u[1],j=Object(r.useState)(A.Filter.All),b=Object(i.a)(j,2),m=b[0],v=b[1],y=Object(r.useState)(q),x=Object(i.a)(y,2),T=x[0],N=x[1],E=Object(r.useState)(null),C=Object(i.a)(E,2),w=C[0],F=C[1],L=Object(r.useState)(!1),B=Object(i.a)(L,2),Y=B[0],G=B[1],H=o.every((function(e){return e.completed})),M=Object(r.useState)(H),R=Object(i.a)(M,2),V=R[0],W=R[1],z=Object(r.useMemo)((function(){return function(e,t){var n=Object(k.a)(e);switch(t){case S.a.Active:return n.filter((function(e){return!e.completed}));case S.a.Completed:return n.filter((function(e){return e.completed}));case S.a.All:default:return n}}(o,m)}),[o,m]);Object(r.useEffect)((function(){try{(function(){var e=Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O("/todos?userId=".concat(t));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(e){return a(e)}))}catch(e){N({state:!0,type:A.ErrorType.Update})}}),[]);return(null===e||void 0===e?void 0:e.id)?Object(g.jsxs)("div",{className:"todoapp",children:[Object(g.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(g.jsxs)("div",{className:"todoapp__content",children:[Object(g.jsx)(K,{todos:o,addTodo:function(e){var n,r;e?(f({id:0,userId:t,title:e,completed:!1}),(n=t,r={userId:t,title:e,completed:!1},h("/todos?userId=".concat(n),r)).then((function(e){a((function(t){return[].concat(Object(k.a)(t),[e])}))})).finally((function(){f(null)}))):N({state:!0,type:A.ErrorType.EmptyTitle})},tempTodo:p,toggleCompletedStatus:function(){G(!0),W((function(e){return!e}));var e=o.map((function(e){return P(e.id,{completed:V})}));Promise.all(e).then(a).finally((function(){G(!1)}))}}),o.length>0&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(I,{todos:z,tempTodo:p,removeTodo:function(e){F(e),D(e).then((function(){a(o.filter((function(t){return t.id!==e})))})).catch((function(){N({state:!0,type:A.ErrorType.Delete})})).finally((function(){F(null)}))},removedTodoId:w,updateTodo:function(e,t){F(e),P(e,t).then((function(t){var n=Object(k.a)(o);n[Object(k.a)(o).findIndex((function(t){return t.id===e}))]=t,a(n)})).catch((function(){N({state:!0,type:A.ErrorType.Update})})).finally((function(){F(null)}))},isLoadingAll:Y}),Object(g.jsx)(U,{todos:o,setFilter:v,filter:m,removeCompletedTodos:function(){var e=o.filter((function(e){return e.completed})),t=o.filter((function(e){return!e.completed})),n=e.map((function(e){return D(e.id)}));Promise.all(n).then((function(){return a(t)})).catch((function(){N({state:!0,type:A.ErrorType.Delete})}))}})]})]}),T.state&&Object(g.jsx)(J,{setError:N,errorText:T.type})]}):Object(g.jsx)("p",{children:"Please login"})};a.a.render(Object(g.jsx)(E,{children:Object(g.jsx)(s.a,{children:Object(g.jsx)(B,{})})}),document.getElementById("root"))}],[[34,1,2]]]);
//# sourceMappingURL=main.aea9c1d8.chunk.js.map