(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],[,,,,,,function(e,t,n){"use strict";var o=n(16);n.o(o,"ErrorType")&&n.d(t,"ErrorType",(function(){return o.ErrorType})),n.o(o,"Filter")&&n.d(t,"Filter",(function(){return o.Filter})),n.o(o,"KeyType")&&n.d(t,"KeyType",(function(){return o.KeyType}));var r=n(17);n.d(t,"ErrorType",(function(){return r.a}));var c=n(9);n.d(t,"Filter",(function(){return c.a}));var a=n(18);n.o(a,"KeyType")&&n.d(t,"KeyType",(function(){return a.KeyType}));var u=n(19);n.o(u,"KeyType")&&n.d(t,"KeyType",(function(){return u.KeyType}));var i=n(20);n.o(i,"KeyType")&&n.d(t,"KeyType",(function(){return i.KeyType}));var s=n(21);n.d(t,"KeyType",(function(){return s.a}))},,,function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.All="All",e.Completed="Completed",e.Active="Active"}(o||(o={}))},,,,,,,function(e,t){},function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.EmptyTitle="Title can't be empty",e.Delete="Unable to delete a todo",e.Add="Unable to add a todo",e.Update="Unable to update a todo",e.None="None"}(o||(o={}))},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.Enter="Enter",e.Escape="Escape"}(o||(o={}))},,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,,function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(22),c=n.n(r),a=n(14),u=(n(27),n(28),n(29),n(30),n(5)),i=n(2),s=n.n(i),l=n(4),d=n(3),p=n(7),f=n.n(p),j="https://mate.academy/students-api";function b(e){return new Promise((function(t){setTimeout(t,e)}))}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o={method:t};return n&&(o.body=JSON.stringify(n),o.headers={"Content-Type":"application/json; charset=UTF-8"}),b(300).then((function(){return fetch(j+e,o)})).then((function(e){if(!e.ok)throw new Error;return e.json()}))}var y=function(e){return m(e)},O=function(e,t){return m(e,"POST",t)},h=function(e,t){return m(e,"PATCH",t)},v=function(e){return m(e,"DELETE")},T=n(9),x=function(e){return e.filter((function(e){return!e.completed})).length},g=function(e){return e.some((function(e){return e.completed}))},_=n(1),N=function(e){var t=e.addTodo,n=e.tempTodo,r=e.toggleCompletedStatus,c=e.todos,a=Object(o.useState)(""),u=Object(d.a)(a,2),i=u[0],s=u[1];return Object(_.jsxs)("header",{className:"todoapp__header",children:[Object(_.jsx)("button",{type:"button",className:f()("todoapp__toggle-all",{active:!x(c)}),onClick:r}),Object(_.jsx)("form",{onSubmit:function(e){e.preventDefault(),t(i),s("")},children:Object(_.jsx)("input",{disabled:!!n,name:"title",value:i,onChange:function(e){s(e.target.value)},type:"text",className:"todoapp__new-todo",placeholder:"What needs to be done?"})})]})},E=n(6),k=function(e){var t=e.todo,n=e.removeTodo,r=e.removedTodoId,c=e.updateTodo,a=e.isLoadingAll,u=t.id,i=t.title,s=t.completed,l=Object(o.useState)(i),p=Object(d.a)(l,2),j=p[0],b=p[1],m=Object(o.useState)(""),y=Object(d.a)(m,2),O=y[0],h=y[1],v=Object(o.useState)(!0),T=Object(d.a)(v,2),x=T[0],g=T[1],N=!1,k=j!==O,C=function(e){g(!0),h(""),e.currentTarget.blur()},S=function(e){c(u,{title:e.currentTarget.value}),b(e.currentTarget.value),C(e)};return Object(_.jsxs)("li",{className:f()("todo",{completed:s}),children:[Object(_.jsx)("label",{className:"todo__status-label",children:Object(_.jsx)("input",{type:"checkbox",className:"todo__status",checked:s,onChange:function(){c(u,{completed:!s})}})}),Object(_.jsx)("input",{type:"text",placeholder:j,value:O,onChange:function(e){h(e.target.value)},onDoubleClick:function(e){!function(e){g(!1),h(j),e.currentTarget.focus()}(e)},className:f()("todo__title",{"todo__title-transparent":!x}),readOnly:x,onKeyDown:function(e){e.key!==E.KeyType.Enter||O||n(u),e.key===E.KeyType.Enter&&!k&&O&&C(e),e.key===E.KeyType.Enter&&k&&O&&S(e),e.key===E.KeyType.Escape&&(N=!0,e.currentTarget.blur(),N=!1)},onBlur:function(e){N?C(e):O?k?k&&S(e):C(e):n(u)}}),Object(_.jsx)("button",{type:"button",className:"todo__remove",onClick:function(){return n(u)},hidden:!x,children:"\xd7"}),(r===u||a)&&Object(_.jsxs)("div",{className:"overlay",children:[Object(_.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(_.jsx)("div",{className:"loader"})]})]})},C=function(e){var t=e.todos,n=e.tempTodo,o=e.removeTodo,r=e.removedTodoId,c=e.updateTodo,a=e.isLoadingAll;return Object(_.jsxs)("ul",{className:"todoapp__main",children:[t.map((function(e){return Object(_.jsx)(k,{todo:e,removeTodo:o,removedTodoId:r,updateTodo:c,isLoadingAll:a},e.id)})),n&&Object(_.jsxs)("div",{className:"todo",children:[Object(_.jsx)("label",{className:"todo__status-label",children:Object(_.jsx)("input",{type:"checkbox",className:"todo__status"})}),Object(_.jsx)("input",{defaultValue:n.title,className:"todo__title",disabled:!0}),Object(_.jsx)("button",{type:"button",className:"todo__remove",children:"\xd7"}),Object(_.jsxs)("div",{className:"overlay",children:[Object(_.jsx)("div",{className:"modal-background has-background-white-ter"}),Object(_.jsx)("div",{className:"loader"})]})]})]})},S=["All","Active","Completed"],K=function(e){return v("/todos/".concat(e))},A=function(e,t){return h("/todos/".concat(e),t)},w=function(e){var t=e.todos,n=e.setFilter,o=e.filter,r=e.removeCompletedTodos,c=function(e){var t=e.currentTarget.textContent;t&&n(E.Filter[t])};return Object(_.jsxs)("footer",{className:"todoapp__footer",children:[Object(_.jsx)("span",{className:"todo-count",children:"".concat(x(t)," items left")}),Object(_.jsx)("nav",{className:"filter",children:S.map((function(e){return Object(_.jsx)(a.b,{to:"All"===e?"../":"../".concat(e.toLowerCase()),className:f()("filter__link",{selected:e===o}),onClick:c,children:e},e)}))}),Object(_.jsx)("button",{type:"button",className:f()("todoapp__clear-completed",{"todoapp__clear-completed-disabled":!g(t)}),onClick:r,children:"Clear completed"})]})},I=function(e){var t=e.setError,n=e.errorText,r=Object(o.useState)(!0),c=Object(d.a)(r,2),a=c[0],u=c[1],i=function(){u(!1),setTimeout((function(){t({state:!1,type:E.ErrorType.None})}),1e3)};return Object(o.useEffect)((function(){setTimeout((function(){i()}),3e3)}),[]),Object(_.jsxs)("div",{className:f()("notification","is-danger","is-light","has-text-weight-normal",{hidden:!a}),children:[Object(_.jsx)("button",{type:"button",className:"delete",onClick:i}),n]})},F={state:!1,type:E.ErrorType.None},D=6657,U=JSON.parse(localStorage.getItem("todos")||"[]"),L=function(){var e=Object(o.useState)(U),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(o.useState)(null),a=Object(d.a)(c,2),i=a[0],p=a[1],f=Object(o.useState)(E.Filter.All),j=Object(d.a)(f,2),b=j[0],m=j[1],h=Object(o.useState)(F),v=Object(d.a)(h,2),x=v[0],g=v[1],k=Object(o.useState)(null),S=Object(d.a)(k,2),L=S[0],J=S[1],P=Object(o.useState)(!1),B=Object(d.a)(P,2),G=B[0],H=B[1],M=n.every((function(e){return e.completed})),V=Object(o.useState)(M),W=Object(d.a)(V,2),q=W[0],z=W[1],Q=Object(o.useMemo)((function(){return function(e,t){var n=Object(u.a)(e);switch(t){case T.a.Active:return n.filter((function(e){return!e.completed}));case T.a.Completed:return n.filter((function(e){return e.completed}));case T.a.All:default:return n}}(n,b)}),[n,b]);Object(o.useEffect)((function(){if(!U.length)try{(function(){var e=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y("/todos?userId=".concat(D));case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()().then((function(e){return r(e)}))}catch(e){g({state:!0,type:E.ErrorType.Update})}}),[]),Object(o.useEffect)((function(){localStorage.setItem("todos",JSON.stringify(n))}),[n]);return Object(_.jsxs)("div",{className:"todoapp",children:[Object(_.jsx)("h1",{className:"todoapp__title",children:"todos"}),Object(_.jsxs)("div",{className:"todoapp__content",children:[Object(_.jsx)(N,{todos:n,addTodo:function(e){var t,n;e?(p({id:0,userId:D,title:e,completed:!1}),(t=D,n={userId:D,title:e,completed:!1},O("/todos?userId=".concat(t),n)).then((function(e){r((function(t){return[].concat(Object(u.a)(t),[e])}))})).finally((function(){p(null)}))):g({state:!0,type:E.ErrorType.EmptyTitle})},tempTodo:i,toggleCompletedStatus:function(){H(!0),z((function(e){return!e}));var e=n.map((function(e){return A(e.id,{completed:q})}));Promise.all(e).then(r).finally((function(){H(!1)}))}}),n.length>0&&Object(_.jsxs)(_.Fragment,{children:[Object(_.jsx)(C,{todos:Q,tempTodo:i,removeTodo:function(e){J(e),K(e).then((function(){r(n.filter((function(t){return t.id!==e})))})).catch((function(){g({state:!0,type:E.ErrorType.Delete})})).finally((function(){J(null)}))},removedTodoId:L,updateTodo:function(e,t){J(e),A(e,t).then((function(t){var o=Object(u.a)(n);o[Object(u.a)(n).findIndex((function(t){return t.id===e}))]=t,r(o)})).catch((function(){g({state:!0,type:E.ErrorType.Update})})).finally((function(){J(null)}))},isLoadingAll:G}),Object(_.jsx)(w,{todos:n,setFilter:m,filter:b,removeCompletedTodos:function(){var e=n.filter((function(e){return e.completed})),t=n.filter((function(e){return!e.completed})),o=e.map((function(e){return K(e.id)}));Promise.all(o).then((function(){return r(t)})).catch((function(){g({state:!0,type:E.ErrorType.Delete})}))}})]})]}),x.state&&Object(_.jsx)(I,{setError:g,errorText:x.type})]})};c.a.render(Object(_.jsx)(a.a,{children:Object(_.jsx)(L,{})}),document.getElementById("root"))}],[[33,1,2]]]);
//# sourceMappingURL=main.f469fed6.chunk.js.map